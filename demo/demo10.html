<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>积分图</title>
</head>

<body>
  <img id="input" src="../img/lena.jpg" alt="">
  <canvas id="gray"></canvas>
  <canvas id="integral"></canvas>
  <script src="../lib/opencv.js" type="text/javascript"></script>
  <script>
    window.onload = function () {
      var $input = document.querySelector('#input');
      var src = cv.imread($input);
      let gray = new cv.Mat();
      cv.cvtColor(src, gray, cv.COLOR_RGBA2GRAY);
      var $gray = document.querySelector('#gray');
      cv.imshow($gray, gray);

      var integral = new cv.Mat();
      var $integral = document.querySelector('#integral');
      cv.integral(gray, integral, cv.CV_32F); //计算积分图
      cv.normalize(integral, integral, 0, 1, cv.NORM_MINMAX); //归一化，方便显示
      cv.imshow($integral, integral);
    }
  </script>
</body>

</html>